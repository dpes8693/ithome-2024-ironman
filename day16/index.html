<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>打開 YouTube 應用程序</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
      }
      button {
        padding: 10px 20px;
        font-size: 18px;
        cursor: pointer;
        margin-bottom: 20px;
      }
      #message {
        text-align: center;
        display: none;
      }
    </style>
  </head>
  <body>
    <h3>試著用不同的手機瀏覽點按鈕，嘗試開啟App</h3>
    <button id="openYouTubeApp1" data-url="youtube://">打開 youtube://</button>
    <button id="openYouTubeApp2" data-url="https://www.youtube.com/">
      打開 https://www.youtube.com/
    </button>
    <div id="message"></div>

    <script>
      const openApp1 = document.getElementById("openYouTubeApp1");
      const openApp2 = document.getElementById("openYouTubeApp2");
      const messageElement = document.getElementById("message");

      const main = (e) => {
        const youtubeAppUrl = e.target.dataset.url;
        let appOpenedSuccessfully = false;

        // 添加一個事件監聽器來檢測頁面是否變為不可見（表示應用程序已打開）
        document.addEventListener("visibilitychange", () => {
          if (document.hidden) {
            appOpenedSuccessfully = true;
            showMessage("YouTube 應用程序已成功打開！");
          }
        });

        // openYouTube
        try {
          showMessage("嘗試打開 YouTube App ...");
          jump(youtubeAppUrl);

          // 2秒後檢查
          setTimeout(() => {
            if (!appOpenedSuccessfully) {
              showMessage("無法打開 YouTube App 3秒後跳轉...", true);
              setTimeout(() => jump("https://www.youtube.com/"), 3000);
            }
          }, 2000);
        } catch (error) {
          console.error("發生錯誤:", error);
          showMessage("嘗試打開 YouTube 時發生錯誤", true);
        }
      };

      openApp1.addEventListener("click", main);
      openApp2.addEventListener("click", main);

      function showMessage(text, isError = false) {
        messageElement.textContent = text;
        messageElement.style.color = isError ? "red" : "green";
        messageElement.style.display = "block";
      }

      function jump(url) {
        window.location.href = url;
      }
    </script>
  </body>
</html>
