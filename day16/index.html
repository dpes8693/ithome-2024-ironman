<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ‰“é–‹ App</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
      }
      button {
        padding: 10px 20px;
        font-size: 18px;
        cursor: pointer;
        margin-bottom: 20px;
      }
      #message {
        text-align: center;
        display: none;
      }
    </style>
  </head>
  <body>
    <h3>è©¦è‘—ç”¨ä¸åŒçš„æ‰‹æ©Ÿç€è¦½é»æŒ‰éˆ•ï¼Œå˜—è©¦é–‹å•ŸApp</h3>
    <button
      id="openYouTubeApp1"
      data-url="youtube://"
      data-name="YouTube"
      data-website="https://www.youtube.com/"
    >
      æ‰“é–‹ youtube://ğŸ“± https://www.youtube.com/
    </button>
    <button
      id="openGoogleMapApp1"
      data-url="comgooglemaps://"
      data-name="Google Maps"
      data-website="http://maps.google.com/maps"
    >
      æ‰“é–‹ comgooglemaps://ğŸ“± http://maps.google.com/maps
    </button>
    <button
      id="openIgApp1"
      data-url="instagram://app"
      data-name="instagram"
      data-website="https://www.instagram.com/"
    >
      æ‰“é–‹ instagram://appğŸ“± https://www.instagram.com/
    </button>
    <div id="message"></div>

    <script>
      const messageElement = document.getElementById("message");

      const main = (e) => {
        const appUrl = e.target.dataset.url;
        const appName = e.target.dataset.name;
        const appWebsite = e.target.dataset.website;
        let appOpenedSuccessfully = false;

        // æ·»åŠ ä¸€å€‹äº‹ä»¶ç›£è½å™¨ä¾†æª¢æ¸¬é é¢æ˜¯å¦è®Šç‚ºä¸å¯è¦‹ï¼ˆè¡¨ç¤ºæ‡‰ç”¨ç¨‹åºå·²æ‰“é–‹ï¼‰
        document.addEventListener("visibilitychange", () => {
          if (document.hidden) {
            appOpenedSuccessfully = true;
            showMessage(`${appName} æ‡‰ç”¨ç¨‹åºå·²æˆåŠŸæ‰“é–‹ï¼`);
          }
        });

        // openYouTube
        try {
          showMessage(`å˜—è©¦æ‰“é–‹ ${appName} App ...`);
          jump(appUrl);

          // 2ç§’å¾Œæª¢æŸ¥
          setTimeout(() => {
            if (!appOpenedSuccessfully) {
              showMessage(`ç„¡æ³•æ‰“é–‹ ${appName} App 3ç§’å¾Œè·³è½‰...`, true);
              setTimeout(() => jump(appWebsite), 3000);
            }
          }, 2000);
        } catch (error) {
          console.error("ç™¼ç”ŸéŒ¯èª¤:", error);
          showMessage(`å˜—è©¦æ‰“é–‹ ${appName} æ™‚ç™¼ç”ŸéŒ¯èª¤`, true);
        }
      };

      openYouTubeApp1.addEventListener("click", main);
      openGoogleMapApp1.addEventListener("click", main);
      openIgApp1.addEventListener("click", main);

      function showMessage(text, isError = false) {
        messageElement.textContent = text;
        messageElement.style.color = isError ? "red" : "green";
        messageElement.style.display = "block";
      }

      function jump(url) {
        window.location.href = url;
      }
    </script>
  </body>
</html>
